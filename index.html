<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- <script src="JSPrintManager.js"></script> -->
    <script src="./node_modules/jsprintmanager/JSPrintManager.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

</head>

<body>
    <div style="text-align:center">
        <h1>Print Zebra ZPL commands from Javascript</h1>
        <hr />
        <label class="checkbox">
        <input type="checkbox" id="useDefaultPrinter" /> <strong>Print to Default printer</strong>
    </label>
        <p>or...</p>
        <div id="installedPrinters">
            <label for="installedPrinterName">Select an installed Printer:</label>
            <select name="installedPrinterName" id="installedPrinterName"></select>
        </div>
        <br /><br />
        <button type="button" onclick="print();">Print Now...</button>
    </div>
</body>

<script>
    //WebSocket settings
    JSPM.JSPrintManager.auto_reconnect = true;
    JSPM.JSPrintManager.start();
    JSPM.JSPrintManager.WS.onStatusChanged = function() {
        if (jspmWSStatus()) {
            //get client installed printers
            JSPM.JSPrintManager.getPrinters().then(function(myPrinters) {
                var options = '';
                for (var i = 0; i < myPrinters.length; i++) {
                    options += '<option>' + myPrinters[i] + '</option>';
                }
                $('#installedPrinterName').html(options);
            });
        }
    };

    //Check JSPM WebSocket status
    function jspmWSStatus() {
        if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Open)
            return true;
        else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Closed) {
            alert('JSPrintManager (JSPM) is not installed or not running! Download JSPM Client App from https://neodynamic.com/downloads/jspm');
            return false;
        } else if (JSPM.JSPrintManager.websocket_status == JSPM.WSStatus.Blocked) {
            alert('JSPM has blocked this website!');
            return false;
        }
    }

    //Do printing...
    function print(o) {
        if (jspmWSStatus()) {
            //Create a ClientPrintJob
            var cpj = new JSPM.ClientPrintJob();
            //Set Printer type (Refer to the help, there many of them!)
            if ($('#useDefaultPrinter').prop('checked')) {
                cpj.clientPrinter = new JSPM.DefaultPrinter();
            } else {
                cpj.clientPrinter = new JSPM.InstalledPrinter($('#installedPrinterName').val());
            }
            //Set content to print...
            //Create Zebra ZPL commands for sample label
            var cmds = "^XA";
            cmds += "^CF0,30";
            cmds += "^FO250,410^GFA,480,480,8,,:::::M03,K0404C4,J01C0C6,J03B9C382,J021881C1,J06J0F04,J0EJ0382,J0FC4001C1,I01FFEI0F08,0011E3EI0384,0020E3CI01C,0020E38J0E,0060F78J07,0040FFK038,00407EK01C,J07CL0E,J07EL07,0040FEL03,0060FFL018,00E1EF8K018,0073E7CL0C,0073C3EL0C,007F83FL04,003FF1F8K04,003JFCK04,001E007EK04,001E003F,001F001F8,003F800FC,013BC007E,0139E01FF,00BLF8,00JF80F8,007FFC007C,00703E007C,00301F003E,003807807E,001C03C7FF,001E03FFCF,I0JFC0F,I07IF007,J0603807,J0301C06,J0180C06,K060E04,K01860C,L042,M02,,:::::^FS";
            // cmds += "^FO250,450^GFA,200,200,5,,:::K0C,I0612,I0DB18,001800C,0018007,003FC018,0039C00C,00398006,021FI03,021FI018,I0EJ0C,021EJ06,023FJ02,033B8I03,0371CI01,03F1EI01,01IF,01C078,01E03C,01F01E,0738FF,07FFC78,03CE038,010701C,018383C,01C1FEE,00IF0E,0018604,I0C304,I02104,J0I8,K08,,:::^FS";
            cmds += "^FO335,430^FDCIHEB Tanzania^FS";
            cmds += "^BY2,2,80";
            cmds += "^FO265,470^BC^FD12345678^FS";
            cmds += "^FO20,30^GB750,1100,4^FS";
            // cmds += "^FO20,30^GB750,200,4^FS";
            // cmds += "^FO20,30^GB750,400,4^FS";
            // cmds += "^FO20,30^GB750,700,4^FS";
            // cmds += "^FO20,226^GB325,204,4^FS";
            // cmds += "^FO30,40^ADN,36,20^FDShip to:^FS";
            // cmds += "^FO30,260^ADN,18,10^FDPart number #^FS";
            // cmds += "^FO360,260^ADN,18,10^FDDescription:^FS";
            // cmds += "^FO30,750^ADN,36,20^FDFrom:^FS";
            // cmds += "^FO150,125^ADN,36,20^FDAcme Printing^FS";
            // cmds += "^FO60,330^ADN,36,20^FD14042^FS";
            // cmds += "^FO400,330^ADN,36,20^FDScrew^FS";
            // cmds += "^FO70,480^BY4^B3N,,200^FD12345678^FS";
            // cmds += "^FO150,800^ADN,36,20^FDMacks Fabricating^FS";
            // cmds += "^FO30,30";
            // cmds += "^GFA,11400,11400,38,,:::::::::::::::::::::::::::gW03,gW03C,gW06E007,gW0E780078,gP038K0E3EI0FC,gO03CK01E3F8001F8,gN01FL03E1FCI03F,gN0F8L03E0FFJ07E,gM07EM07E07FCJ0FC,gL03F8M0FE03FFJ01F,gL0FEN0FE01FF8J07E,gK03FCM01FE00FFEJ01F8,gK0FFN03FE007FF8J07E,gJ03FFN03FC003FFCK0F8,gI01IFEM07FC001IFK03E,gI07BFFCM0FFCI0IF8K0F8,gI0E7FF00FK0FFCI03FFEK03E,gH038FFE01FCI01FF8I01IF8K0F8,gH0F3FF807FEI03FF8J0IFCK03E,gG03C7FF00FFEI03FF8J07IFL0F8,gG070FFC01FFEI07FFK03IF8K03E,g01C1FC007FFEI07FFL0IFEK01F8,g0383F8007IFI03FFL07IFL07C,g0607F8I0IFI03FEL03IFCK01F,Y01C0FFK0FFI01FEL01IFEL0FC,Y0301FEL0FJ0FCM07IF8K03E,Y0603FEL01J0FCM03IFCL0F8,X01C07FEQ07CM01IFEL07C,X03007FCQ038N0JF8K01F,X0600FFCQ038N03IFCL0F8,X0C01FF8Q01O01IFEL07C,W01801FF8gH0JF8K01F,W07003FF8gH03IFCL0F8,W0E003FF8gH01IFEL07C,V01C007FFN01U0JF8K03E,V038007FFN038T03IFCL0F8,V07I07JFL038T01IFEL07C,V0EI0LF8J07CU0JF8K03E,U01C001MF8I0FEU03IFCK01F,U038001NFI0FEU01JFL0F8,U07I01NFC01FFV0JF8K03C,U06I01OF03FFV03IFCK01E,U0CI03OF87FF8U01JFL0F,T01CI03OFE7FFCV0JF8K078,T038I03SFEV07IFCK03C,T07J03SFEV01IFEK01C,T07J03TFW0JF8K0E,T0EJ03IF81NFEW07IFCK07,S01CJ03IF800MFCW03IFEK038,S03CJ03IF8I0LFCX0JFK01C,S038J03IFCI01KF8X07IFCK0E,S078J03IFCJ07JF8X03IFEK0E,S0FK03IFCJ03JFY01JFK07,S0FK03IFCJ07IFEg0JF8J038,R01EK03IFEJ0JFEg03IFCJ018,R01EK03IFEI01JFCg01IFEK0C,R03CK03JFI03JF8gG0JF8J0E,R03CK03JFI03JF8gG07IFCJ06,R07CK03JFI07JFgH03IFEJ03,R078K01JF800JFEgH01JFJ018,R0F8K01JF801JFCgI07IFCI018,R0F8K01JFC03JFCgI03IFEJ0C,Q01FL01JFC07JF8gI01JFJ04,Q01FM0JFE0KFgK0JF8I06,Q01FM0JFE1KFgK07IFCI02,Q03FM0KF1JFEgK03IFEI01,Q03FM0KF3JFCgK01JF,Q03EM07OFCgL0JF8,Q07EM07OF8gL07IFC,Q07EM07OFgM03IFE,Q07CM03NFEgM01JF,Q0FCM03NFEgN0JF,Q0F8M01NFCgN07IF8,Q0FN01NF8gN03IFC,Q0FO0NFgO01IFE,Q0EO0NFgP0JF,P01EO07LFEgP07IF,P01CO07LFCgP03IF8,P018O03LF8gP01IFC,P018O03LFgR0IFE,P01P01LFgR07FFE,P01P01KFEgR03IF,gH0KFEgR01IF8,gG01LFgS0IF8,R02N03LF8gR07FFC,R06N03LFCgR07FFE,R06N07LFCgR03FFE,R0EN0MFEgR01IF,R0FM01NFgS0IF,Q01FM03NF8gR07FF8,Q01FM03NFCgR03FFC,Q03FM07NFEgR03FFC,Q03F8L0PFgR01FFE,Q07F8K01PF8gR0FFE,Q07F8K01PFCgR07FF,Q0FFCK03PFEgR07FF,Q0FFCK07PFEgR03FF8,P01FFCK07QFgR01FF8,P01FFEK0KF9LF8gQ01FFC,P01FFEJ01KF8LFCgR0FFC,P01IFJ01KF0LFEgR07FC,P01IFJ03JFE07LFgR07FE,P01IFJ07JFC03LF8gQ03FE,P01IF8I0KF801LFCgQ01FF,Q0IF8I0KF800LFEgQ01FF,Q0IFC001KFI0MFgR0FF8,Q0IFC003JFEI07LFCgQ0FF8,Q0IFE003JFEI03LFEgQ07F8,Q0JF007JFCI01MFgQ07F8,Q07IF00KF8J0MF8gP03FC,Q07IF80KF8J07LFCgP03FC,Q07IF81KFK03LFEgP01FC,Q03IFC3JFEK03MFgP01FE,Q03IFC3JFEK01MF8gO01FE,Q01IFE7JFCL0MFCgP0FE,Q01OF8L07LFEgP0FE,Q01OF8L03MFgP0FF,R0OFM01MF8gO07F,R0OFEM0MFCgO07F,R07RF8I07LFEgO07F,R07UFE7MFgO07F,R03gJF8gN03F,R03gJFCgN03F,R01gJFEgN03F,R01gKFgN03F,S0gKF8gM01F,S07gJFCgM01F,S07gJFEgM01F,S03KF8YFgM01F,S03KFR07MF8gL01F,S01KFR01MFCgL01F,T0JFES0MFEgM0F,T0JFES07MFgM0F,S01KFS03MF8gL0F,S01KF8R01MFCgL0F,S03KF8S0MFCgL0F,S03KFCS07LFEgL0F,S03KFES03MFgL0F,S07LFS01MF8gK0F,S07LFT0MFCgK0F,N02J0MF8S07LFEgK0F,N02J0MFCS03MFgK0F,N03J0MFES01MF8gJ0E,N03I01NFT0MFCgJ0E,N038001NF8S07LFCgJ0E,N038001NFCS03LFEgJ0E,N03C003NFES01MFgJ0E,N01C003NFET0MF8gI0E,N01E003IFCKFT07LFCgI0C,N01E003IFC7JF8S03LFEgI0C,N01F007IF87JFCS01MFgI0C,N01F007IF83JFES01MFgI0C,O0F807IF01KFS01MF8gG01C,O0F807IF00KF8Q0OFCgG01C,O0FC07IF007JFCO0QFEgG018,O07E07FFE003JFEM07RFEgG018,O07E0IFE001KFK07UFgG018,O07F0IFEI0KF801XF8g03,O03F8IFCI07gKFCg03,O03F8JFC007XFBLFCg03,O01FCgKF01LFEg02,O01FCgJFI0MFg06,O01FEgHFCJ07LF8Y06,P0gIF8K03LF8Y06,P0gHFM01LFCY0C,P07YFCN01LFEY0C,P07WFEQ0LFEY08,P03VF8R07LFX018,P01VFS03LF8W01,P01VF8R03LF8W03,Q0NF800KFCR01LFCW03,Q0IFEM07JFES0LFCW02,Q07FFEM03KFS07KFEW06,Q03FFEM01KF8R03LFW04,Q01FFEN0KFCR03LFW0C,R0FFEN03JFER01LF8V08,R07FEN01KFS0LF8U018,R07FEO0KF8R07KFCU01,R07FFO07JFCR03KFCU02,R03FF8N03JFER03KFEU02,R03FFCN01KFR01KFEU04,R03FFCO0KF8R0LF,R01FFEO07JFCR0LF,R01IFO03JFEQ01LF,R01IF8N01KFQ0MF8,S0IFCO0KF8O0NF8,S0IFEO07JFCN0OF8,S07IFO03JFEL01PFC,S07IF8N01KFK01QFC,S03IFCO0KF8I03RFC,S03IFEO03JFC003SFE,S01FBFFO01JFE07OFBJFE,S01F9FF8O0JFEPFE1JFE,T0FCFFCO07TF00JFE,T07C7FEO03SF800JFE,T07JF8N0SFCI07IFE,T03JFCK03TFEJ07IFE,T01gJFEK07IFE,U0gIFEL03IFE,U0gIFM03IFE,U07gGFN01IFE,U03YFEO01IFE,U01YFP01IFE,V0YF8P0IFE,V0YFCP0IFE,V07RFE07IFEP0IFE,V03PFJ03JFP0IFE,V01800IFN01JFP07FFE,W04007FFO0JF8O07FFE,W02001FF8N07IFCO07FFE,W01I0FFCN03IFCO07FFC,gG07FFN01IFEO07FFC,gG01FF8N0JFO03FFC,gH0FFCN07IFO03FFC,gH03FFN03IF8N03FF8,gH01FF8M01IF8N03FF8,gI07FEN0IFCN03FF8,gI03FFN07FFEN03FF,gJ0FFCM07FFEN03FF,gJ07FEM03IFN03FE,gJ01FF8L01IFN03FE,gK0FFCM0IF8M07FC,gK03FFM07FF8M07FC,gL0FFCL03FFCM07F8,gL07FEL03FFCM07F8,gL01FF8K01FFEM0FF,gM07FEL0FFEM0FE,gM01FFL0IFL01FC,gN07FCK07FFL01F8,gN01FFK03FFL03F,gO07F8J01FF8K07E,gO01FEJ01FF8K0FC,gP07FK0FF8J01F8,gP01FCJ07F8J03E,gQ07FJ03F8J07C,gR0F8I03F8J0F,gR03EI01F8I03E,gS078001F8I0F8,gS01EI0F8003C,gT03I0FI07,gU040070018,gX06,,:::::::::::::::::::::::::::::^FS";
            // cmds += "^FO330,30^ADN,36,30^FDCIHEB Tanzania^FS^FO330,70^BY4^B3N,,200^FD12345678^FS";
            cmds += "^XZ";
            cpj.printerCommands = cmds;
            //Send print job to printer!
            console.log(cmds);
            cpj.sendToClient();
        }
    }
</script>

</html>